<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´ªåƒè›‡æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #ffb3b3, #b21f1f, #1a2a6c);
            padding: 20px;
        }
        
        .game-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            padding: 30px;
            width: 100%;
            max-width: 500px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        h1 {
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            font-size: 2.5rem;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            color: white;
            font-size: 1.2rem;
        }
        
        .score-container, .high-score-container, .shield-container {
            display: flex;
            flex-direction: column;
        }
        
        .score-value, .high-score-value, .shield-value {
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        .score-value {
            color: #4caf50;
        }
        
        .high-score-value {
            color: #ff9800;
        }
        
        .shield-value {
            color: #2196F3;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(20, 1fr);
            grid-template-rows: repeat(20, 1fr);
            gap: 1px;
            width: 400px;
            height: 400px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .cell {
            background: rgba(50, 50, 50, 0.3);
            transition: background 0.1s;
        }
        
        .snake {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            border-radius: 3px;
        }
        
        .snake-head {
            background: linear-gradient(135deg, #00C853, #64DD17);
            border-radius: 4px;
            position: relative;
            z-index: 2;
          
        }



      
        .food {
            background: linear-gradient(135deg, #FF5252, #FF4081);
            border-radius: 50%;
            animation: pulse 0.5s infinite alternate;
        }
        
        @keyframes pulse {
            from { transform: scale(0.8); }
            to { transform: scale(1.1); }
        }

        /* å¥–åŠ±é£Ÿç‰©æ ·å¼ */
        .reward-food {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 50%;
            animation: goldPulse 0.6s infinite alternate;
        }

        @keyframes goldPulse {
            from { transform: scale(0.9); opacity: 0.8; }
            to { transform: scale(1.2); opacity: 1; }
        }
        
        /* æŠ¤ç›¾é£Ÿç‰©æ ·å¼ */
        .shield-food {
            background: linear-gradient(135deg, #2196F3, #03A9F4);
            border-radius: 50%;
            animation: shieldPulse 0.7s infinite alternate;
        }

        @keyframes shieldPulse {
            from { transform: scale(0.8); }
            to { transform: scale(1.1); }
        }
        
        /* é‡‘è‰²å…‰åœˆæ•ˆæœ */
        .golden-aura {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, rgba(255,215,0,0) 70%);
            pointer-events: none;
            z-index: 1;
            transform: translate(-50%, -50%);
            animation: auraPulse 1s infinite alternate;
        }
        
        @keyframes auraPulse {
            from { box-shadow: 0 0 10px 5px rgba(255, 215, 0, 0.5); }
            to { box-shadow: 0 0 20px 10px rgba(255, 215, 0, 0.7); }
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            background: linear-gradient(to right, #2196F3, #21CBF3);
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        #restart-btn {
            background: linear-gradient(to right, #FF9800, #FF5722);
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-top: 25px;
            color: #e0e0e0;
            font-size: 0.9rem;
        }
        
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            display: none;
        }
        
        .game-over-content {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            max-width: 90%;
            width: 400px;
        }
        
        .game-over h2 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .final-score {
            color: #FFD700;
            font-size: 1.8rem;
            margin: 20px 0;
        }
        
        .mobile-controls {
            display: none;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .mobile-btn {
            padding: 15px;
            font-size: 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
        
        .up-btn { grid-column: 2; grid-row: 1; }
        .left-btn { grid-column: 1; grid-row: 2; }
        .right-btn { grid-column: 3; grid-row: 2; }
        .down-btn { grid-column: 2; grid-row: 2; }
        
        @media (max-width: 500px) {
            .game-board {
                width: 300px;
                height: 300px;
            }
            
            .mobile-controls {
                display: grid;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .game-info {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸæ²³å—å·¥ä¸šå¤§å­¦ç‰ˆâœ¨ğŸ§§</h1>
        
        <div class="game-info">
            <div class="score-container">
                <div>å½“å‰å¾—åˆ†</div>
                <div class="score-value" id="score">0</div>
            </div>
            <div class="shield-container">
                <div>æŠ¤ç›¾æ•°é‡</div>
                <div class="shield-value" id="shield">0</div>
            </div>
            <div class="high-score-container">
                <div>æœ€é«˜å¾—åˆ†</div>
                <div class="high-score-value" id="high-score">0</div>
            </div>
        </div>
        
        <div class="game-board" id="game-board"></div>
        
        <div class="mobile-controls">
            <button class="mobile-btn up-btn">â†‘</button>
            <button class="mobile-btn left-btn">â†</button>
            <button class="mobile-btn down-btn">â†“</button>
            <button class="mobile-btn right-btn">â†’</button>
        </div>
        
        <div class="controls">
            <button id="start-btn">å¼€å§‹æ¸¸æˆ</button>
            <button id="pause-btn">æš‚åœ</button>
            <button id="restart-btn">é‡æ–°å¼€å§‹</button>
        </div>
        
        <div class="instructions">
            <p>æ¸¸æˆè§„åˆ™ï¼š</p>
            <p>æ™®é€šé£Ÿç‰©100ï¼Œé‡‘è‰²é£Ÿç‰©500ï¼ˆé™„åŠ 6Ã—6èŒƒå›´çš„å¸é™„æ•ˆæœï¼ŒæŒç»­5ç§’ï¼‰ï¼Œæ¯è¿ç»­åƒåˆ°9ä¸ªé£Ÿç‰©å‡ºç°ä¸€ä¸ªè“è‰²é£Ÿç‰©ï¼ˆæŠ¤ç›¾æ•ˆæœå¯å åŠ ï¼Œæ’åˆ°è‡ªèº«æˆ–è€…æ’åˆ°å¢™å£å‡å°‘æŠ¤ç›¾æ•°é‡ï¼‰</p>
            <p>2025å¹´8æœˆ30å·ï¼Œæˆ‘çš„ç¬¬ä¸€æ¬¾ç½‘é¡µæ¸¸æˆä¸Šçº¿ï¼</p>
            <p>è®°å¾—å…³æ³¨ï¼Œä¸å®šæ—¶æ›´æ–°ï¼</p>
        </div>
    </div>
    
    <div class="game-over" id="game-over">
        <div class="game-over-content">
            <h2>èœå°±å¤šç»ƒ!</h2>
            <p>ä½ çš„æœ€ç»ˆå¾—åˆ†:</p>
            <div class="final-score" id="final-score">0</div>
            <button id="play-again-btn">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>

    <script>
        // æ¸¸æˆå¸¸é‡
        const BOARD_SIZE = 20;
        const INITIAL_SPEED = 200;
        const SPEED_INCREMENT = 0.3;
        const ATTRACTION_RADIUS = 3; // 6x6ç½‘æ ¼çš„åŠå¾„
        const ATTRACTION_DURATION = 5000; // 5ç§’æŒç»­æ—¶é—´
        
        // æ¸¸æˆçŠ¶æ€
        let snake = [];
        let food = {};
        let rewardFood = null;
        let shieldFood = null;
        let direction = 'right';
        let nextDirection = 'right';
        let score = 0;
        let shield = 0; // æŠ¤ç›¾å€¼
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        let gameInterval;
        let gameRunning = false;
        let gamePaused = false;
        let speed = INITIAL_SPEED;
        let rewardFoodCount = 0; // é‡‘è‰²å¥–åŠ±é£Ÿç‰©è®¡æ•°å™¨
        let shieldFoodCount = 0; // æŠ¤ç›¾é£Ÿç‰©è®¡æ•°å™¨
        let attractionEndTime = 0; // å¸é™„æ•ˆæœç»“æŸæ—¶é—´
        let auraElement = null; // é‡‘è‰²å…‰åœˆå…ƒç´ 
        
        // DOM å…ƒç´ 
        const gameBoard = document.getElementById('game-board');
        const scoreDisplay = document.getElementById('score');
        const shieldDisplay = document.getElementById('shield');
        const highScoreDisplay = document.getElementById('high-score');
        const finalScoreDisplay = document.getElementById('final-score');
        const startBtn = document.getElementById('start-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const restartBtn = document.getElementById('restart-btn');
        const playAgainBtn = document.getElementById('play-again-btn');
        const gameOverScreen = document.getElementById('game-over');
        
        // åˆå§‹åŒ–æ¸¸æˆæ¿
        function initializeBoard() {
            gameBoard.innerHTML = '';
            for (let i = 0; i < BOARD_SIZE * BOARD_SIZE; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell');
                gameBoard.appendChild(cell);
            }
        }
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            snake = [
                {x: 10, y: 10},
                {x: 9, y: 10},
                {x: 8, y: 10}
            ];
            generateFood();
            rewardFood = null;
            shieldFood = null;
            direction = 'right';
            nextDirection = 'right';
            score = 0;
            shield = 0;
            rewardFoodCount = 0;
            shieldFoodCount = 0;
            speed = INITIAL_SPEED;
            attractionEndTime = 0;
            removeAura();
            scoreDisplay.textContent = score;
            shieldDisplay.textContent = shield;
            highScoreDisplay.textContent = highScore;
            render();
        }
        
        // ç”Ÿæˆé£Ÿç‰©
        function generateFood() {
            let newFood;
            let onSnake;
            do {
                onSnake = false;
                newFood = {
                    x: Math.floor(Math.random() * BOARD_SIZE),
                    y: Math.floor(Math.random() * BOARD_SIZE)
                };
                for (let segment of snake) {
                    if (segment.x === newFood.x && segment.y === newFood.y) {
                        onSnake = true;
                        break;
                    }
                }
                // æ£€æŸ¥æ˜¯å¦ä¸å¥–åŠ±é£Ÿç‰©æˆ–æŠ¤ç›¾é£Ÿç‰©é‡å 
                if (rewardFood && rewardFood.x === newFood.x && rewardFood.y === newFood.y) onSnake = true;
                if (shieldFood && shieldFood.x === newFood.x && shieldFood.y === newFood.y) onSnake = true;
            } while (onSnake);
            food = newFood;
        }

        // ç”Ÿæˆå¥–åŠ±é£Ÿç‰©
        function generateRewardFood() {
            let newFood;
            let onSnake;
            do {
                onSnake = false;
                newFood = {
                    x: Math.floor(Math.random() * BOARD_SIZE),
                    y: Math.floor(Math.random() * BOARD_SIZE)
                };
                for (let segment of snake) {
                    if (segment.x === newFood.x && segment.y === newFood.y) {
                        onSnake = true;
                        break;
                    }
                }
                // æ£€æŸ¥æ˜¯å¦ä¸æ™®é€šé£Ÿç‰©æˆ–æŠ¤ç›¾é£Ÿç‰©é‡å 
                if (food.x === newFood.x && food.y === newFood.y) onSnake = true;
                if (shieldFood && shieldFood.x === newFood.x && shieldFood.y === newFood.y) onSnake = true;
            } while (onSnake);
            rewardFood = newFood;
        }

        // ç”ŸæˆæŠ¤ç›¾é£Ÿç‰©
        function generateShieldFood() {
            let newFood;
            let onSnake;
            do {
                onSnake = false;
                newFood = {
                    x: Math.floor(Math.random() * BOARD_SIZE),
                    y: Math.floor(Math.random() * BOARD_SIZE)
                };
                for (let segment of snake) {
                    if (segment.x === newFood.x && segment.y === newFood.y) {
                        onSnake = true;
                        break;
                    }
                }
                // æ£€æŸ¥æ˜¯å¦ä¸æ™®é€šé£Ÿç‰©æˆ–å¥–åŠ±é£Ÿç‰©é‡å 
                if (food.x === newFood.x && food.y === newFood.y) onSnake = true;
                if (rewardFood && rewardFood.x === newFood.x && rewardFood.y === newFood.y) onSnake = true;
            } while (onSnake);
            shieldFood = newFood;
        }
        
        // åˆ›å»ºé‡‘è‰²å…‰åœˆ
        function createAura() {
            removeAura();
            auraElement = document.createElement('div');
            auraElement.classList.add('golden-aura');
            gameBoard.appendChild(auraElement);
            updateAuraPosition();
        }
        
        // æ›´æ–°é‡‘è‰²å…‰åœˆä½ç½®
        function updateAuraPosition() {
            if (!auraElement) return;
            
            const head = snake[0];
            const cellSize = gameBoard.offsetWidth / BOARD_SIZE;
            const x = (head.x + 0.5) * cellSize;
            const y = (head.y + 0.5) * cellSize;
            
            auraElement.style.width = `${ATTRACTION_RADIUS * 2 * cellSize}px`;
            auraElement.style.height = `${ATTRACTION_RADIUS * 2 * cellSize}px`;
            auraElement.style.left = `${x}px`;
            auraElement.style.top = `${y}px`;
        }
        
        // ç§»é™¤é‡‘è‰²å…‰åœˆ
        function removeAura() {
            if (auraElement) {
                gameBoard.removeChild(auraElement);
                auraElement = null;
            }
        }
        
        // å¸é™„6x6ç½‘æ ¼å†…çš„é£Ÿç‰©
        function attractFood() {
            const head = snake[0];
            const now = Date.now();
            
            if (now > attractionEndTime) {
                removeAura();
                return false;
            }
            
            // æ›´æ–°é‡‘è‰²å…‰åœˆä½ç½®
            updateAuraPosition();
            
            // æ£€æŸ¥æ™®é€šé£Ÿç‰©æ˜¯å¦åœ¨èŒƒå›´å†…
            if (food && !isFoodInSnake()) {
                const dx = Math.abs(food.x - head.x);
                const dy = Math.abs(food.y - head.y);
                
                if (dx <= ATTRACTION_RADIUS && dy <= ATTRACTION_RADIUS) {
                    // å°†é£Ÿç‰©ç§»åŠ¨åˆ°è›‡å¤´ä½ç½®
                    food.x = head.x;
                    food.y = head.y;
                    return true;
                }
            }
            
            // æ£€æŸ¥å¥–åŠ±é£Ÿç‰©æ˜¯å¦åœ¨èŒƒå›´å†…
            if (rewardFood) {
                const dx = Math.abs(rewardFood.x - head.x);
                const dy = Math.abs(rewardFood.y - head.y);
                
                if (dx <= ATTRACTION_RADIUS && dy <= ATTRACTION_RADIUS) {
                    // å°†å¥–åŠ±é£Ÿç‰©ç§»åŠ¨åˆ°è›‡å¤´ä½ç½®
                    rewardFood.x = head.x;
                    rewardFood.y = head.y;
                    return true;
                }
            }
            
            // æ£€æŸ¥æŠ¤ç›¾é£Ÿç‰©æ˜¯å¦åœ¨èŒƒå›´å†…
            if (shieldFood) {
                const dx = Math.abs(shieldFood.x - head.x);
                const dy = Math.abs(shieldFood.y - head.y);
                
                if (dx <= ATTRACTION_RADIUS && dy <= ATTRACTION_RADIUS) {
                    // å°†æŠ¤ç›¾é£Ÿç‰©ç§»åŠ¨åˆ°è›‡å¤´ä½ç½®
                    shieldFood.x = head.x;
                    shieldFood.y = head.y;
                    return true;
                }
            }
            
            return false;
        }
        
        // æ£€æŸ¥é£Ÿç‰©æ˜¯å¦åœ¨è›‡èº«ä¸Š
        function isFoodInSnake() {
            for (const segment of snake) {
                if (segment.x === food.x && segment.y === food.y) {
                    return true;
                }
            }
            return false;
        }
        
        // æ¸²æŸ“
        function render() {
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => cell.className = 'cell');
            snake.forEach((segment, index) => {
                const idx = segment.y * BOARD_SIZE + segment.x;
                if (idx >= 0 && idx < cells.length) {
                    cells[idx].classList.add(index === 0 ? 'snake-head' : 'snake');
                }
            });
            const foodIdx = food.y * BOARD_SIZE + food.x;
            cells[foodIdx].classList.add('food');
            if (rewardFood) {
                const rewardIdx = rewardFood.y * BOARD_SIZE + rewardFood.x;
                cells[rewardIdx].classList.add('reward-food');
            }
            if (shieldFood) {
                const shieldIdx = shieldFood.y * BOARD_SIZE + shieldFood.x;
                cells[shieldIdx].classList.add('shield-food');
            }
        }
        
        // ç§»åŠ¨è›‡
        function moveSnake() {
            if (gamePaused) return;
            
            // æ£€æŸ¥æ˜¯å¦éœ€è¦å¸é™„é£Ÿç‰©
            const attracted = attractFood();
            if (attracted) {
                render();
            }
            
            direction = nextDirection;
            const head = {...snake[0]};
            switch (direction) {
                case 'up': head.y--; break;
                case 'down': head.y++; break;
                case 'left': head.x--; break;
                case 'right': head.x++; break;
            }
            
            // æ£€æŸ¥æ˜¯å¦æ’å¢™
            if (head.x < 0 || head.x >= BOARD_SIZE || head.y < 0 || head.y >= BOARD_SIZE) {
                if (shield > 0) {
                    shield--;
                    shieldDisplay.textContent = shield;
                    // å¦‚æœæ’å¢™ä½†æœ‰æŠ¤ç›¾ï¼Œè›‡ä¼šä»å¦ä¸€è¾¹å‡ºç°
                    if (head.x < 0) head.x = BOARD_SIZE - 1;
                    if (head.x >= BOARD_SIZE) head.x = 0;
                    if (head.y < 0) head.y = BOARD_SIZE - 1;
                    if (head.y >= BOARD_SIZE) head.y = 0;
                } else {
                    return gameOver();
                }
            }
            
            // æ£€æŸ¥æ˜¯å¦æ’åˆ°è‡ªå·±
            for (let seg of snake) {
                if (seg.x === head.x && seg.y === head.y) {
                    if (shield > 0) {
                        shield--;
                        shieldDisplay.textContent = shield;
                        // å¦‚æœæ’åˆ°è‡ªå·±ä½†æœ‰æŠ¤ç›¾ï¼Œç§»é™¤æ’åˆ°çš„éƒ¨åˆ†
                        const collisionIndex = snake.findIndex(s => s.x === head.x && s.y === head.y);
                        snake = snake.slice(0, collisionIndex);
                        break;
                    } else {
                        return gameOver();
                    }
                }
            }
            
            snake.unshift(head);
            
            // æ£€æŸ¥æ˜¯å¦åƒåˆ°é£Ÿç‰©
            if (head.x === food.x && head.y === food.y) {
                score += 100;
                scoreDisplay.textContent = score;
                rewardFoodCount++;
                shieldFoodCount++;
                
                // æ£€æŸ¥æ˜¯å¦ç”Ÿæˆé‡‘è‰²å¥–åŠ±é£Ÿç‰©ï¼ˆæ¯5ä¸ªæ™®é€šé£Ÿç‰©ï¼‰
                if (rewardFoodCount >= 5 && !rewardFood) {
                    generateRewardFood();
                    rewardFoodCount = 0;
                }
                
                // æ£€æŸ¥æ˜¯å¦ç”ŸæˆæŠ¤ç›¾é£Ÿç‰©ï¼ˆæ¯9ä¸ªæ™®é€šé£Ÿç‰©ï¼‰
                if (shieldFoodCount >= 9 && !shieldFood) {
                    generateShieldFood();
                    shieldFoodCount = 0;
                }
                
                generateFood();
                if (speed > 50) {
                    speed -= SPEED_INCREMENT;
                    clearInterval(gameInterval);
                    gameInterval = setInterval(gameLoop, speed);
                }
            } else if (rewardFood && head.x === rewardFood.x && head.y === rewardFood.y) {
                score += 500;
                scoreDisplay.textContent = score;
                rewardFood = null;
                rewardFoodCount = 0;
                
                // æ¿€æ´»å¸é™„æ•ˆæœ
                attractionEndTime = Date.now() + ATTRACTION_DURATION;
                createAura();
            } else if (shieldFood && head.x === shieldFood.x && head.y === shieldFood.y) {
                shield += 1;
                shieldDisplay.textContent = shield;
                shieldFood = null;
                shieldFoodCount = 0;
            } else {
                snake.pop();
            }
            render();
        }
        
        // æ¸¸æˆå¾ªç¯
        function gameLoop() { moveSnake(); }
        
        function startGame() {
            if (gameRunning) return;
            initGame();
            gameRunning = true;
            gamePaused = false;
            gameInterval = setInterval(gameLoop, speed);
            startBtn.textContent = 'é‡æ–°å¼€å§‹';
        }
        
        function pauseGame() {
            if (!gameRunning) return;
            gamePaused = !gamePaused;
            pauseBtn.textContent = gamePaused ? 'ç»§ç»­' : 'æš‚åœ';
        }
        
        function gameOver() {
            clearInterval(gameInterval);
            gameRunning = false;
            removeAura();
            if (score > highScore) {
                highScore = score;
                localStorage.setItem('snakeHighScore', highScore);
                highScoreDisplay.textContent = highScore;
            }
            finalScoreDisplay.textContent = score;
            gameOverScreen.style.display = 'flex';
        }
        
        function restartGame() {
            gameOverScreen.style.display = 'none';
            startGame();
        }
        
        function handleKeyPress(e) {
            if (!gameRunning) return;
            switch (e.key) {
                case 'ArrowUp': if (direction !== 'down') nextDirection = 'up'; break;
                case 'ArrowDown': if (direction !== 'up') nextDirection = 'down'; break;
                case 'ArrowLeft': if (direction !== 'right') nextDirection = 'left'; break;
                case 'ArrowRight': if (direction !== 'left') nextDirection = 'right'; break;
                case ' ': pauseGame(); break;
            }
        }
        
        function setupMobileControls() {
            document.querySelector('.up-btn').addEventListener('click', () => { if (direction !== 'down') nextDirection = 'up'; });
            document.querySelector('.down-btn').addEventListener('click', () => { if (direction !== 'up') nextDirection = 'down'; });
            document.querySelector('.left-btn').addEventListener('click', () => { if (direction !== 'right') nextDirection = 'left'; });
            document.querySelector('.right-btn').addEventListener('click', () => { if (direction !== 'left') nextDirection = 'right'; });
        }
        
        startBtn.addEventListener('click', startGame);
        pauseBtn.addEventListener('click', pauseGame);
        restartBtn.addEventListener('click', restartGame);
        playAgainBtn.addEventListener('click', restartGame);
        document.addEventListener('keydown', handleKeyPress);
        
        initializeBoard();
        initGame();
        setupMobileControls();
        highScoreDisplay.textContent = highScore;
    </script>
</body>
</html>
